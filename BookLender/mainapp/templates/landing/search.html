{% extends 'landing/base.html' %}
{% load static %}
{% block title %} Search | Bingle {% endblock %}

{% block content %}

    <form class="d-flex hidden" role="search" method="POST"  onclick="hideTable()" id="search-form">
     {% csrf_token %}
        <input
                class="form-control me-2"
                type="search"
                placeholder="Search"
                name="searchquery"
                required aria-label="Search"
                onclick="hideTable()"
        >
        <button class="btn btn-outline-success" type="submit"  onclick="hideTable()">Search</button>
    </form>

    <div id="search-results" style="display: none;">
        {% if user_profiles %}
            <h2>Users with username '{{ searchquery }}':</h2>
            <ul>
                {% for user_profile in user_profiles %}
                    <li>{{ user_profile.user.get_full_name }}</li>
                {% endfor %}
            </ul>
        {% else %}
            <p>No users found with the username '{{ searchquery }}'.</p>
        {% endif %}
    </div>

{% if user_profiles %}

    <table class="table" id="user-profile-table">
        <thead>
        <tr>
            <th></th>
            <th>Username</th>
            <th>Location</th>
            <th>Review</th>
            <th>User profile</th>
        </tr>
        </thead>
        <tbody>
        {% for profile in user_profiles %}
        <tr>
            <td>
                {% if profile.profile_pic %}
                <img class="rounded-circle custom-img-small" src="{{ profile.profile_pic.url }}" alt="Profile Picture" style="max-width: 100px;">
                {% else %}
                <img class="rounded-circle custom-img-small" src="http://bootdey.com/img/Content/avatar/avatar1.png" alt="Default Profile Picture" style="max-width: 100px;">
                {% endif %}
            </td>
            <td>{{ profile.user.username }}</td>
            <td>{{ profile.current_location }}</td>
            <td>{{ profile.review }}</td>
            <td>
                <a href="{% url 'user_profile' profile.id %}" class="btn btn-primary">View</a>
            </td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
{% endif %}

{% endblock %}
